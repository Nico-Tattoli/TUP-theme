{% assign section_settings = section.settings %}
<div
  class="blocco-prova size-style spacing-style"
  style="{% render 'size-style', settings: section_settings %}{% render 'spacing-style', settings: section_settings %}"
>
  {% if section_settings.heading != blank %}
    <div class="blocco-prova__heading {{ section_settings.heading_preset }}">
      {{ section_settings.heading | escape }}
    </div>
  {% endif %}

  {% if section_settings.description != blank %}
    <p class="blocco-prova__description">{{ section_settings.description }}</p>
  {% endif %}

  {%- form 'customer', class: 'blocco-prova__form' %}
    <div class="blocco-prova__input-group">
      <label
        for="EmailInput-{{ section.id }}"
        class="visually-hidden"
      >
        {{ 'blocks.email_signup.label' | t }}
      </label>
      <input
        id="EmailInput-{{ section.id }}"
        class="blocco-prova__input"
        type="email"
        name="contact[email]"
        autocorrect="off"
        autocapitalize="off"
        autocomplete="email"
        placeholder="{{ section_settings.placeholder }}"
        required
        {% if form.errors %}
          autofocus
          aria-invalid="true"
          aria-describedby="Blocco-prova__message-error-{{ section.id }}"
        {% elsif form.posted_successfully? %}
          aria-describedby="Blocco-prova__message-success-{{ section.id }}"
        {% endif %}
      >
      <button
        class="blocco-prova__button button"
        type="submit"
      >
        {{ section_settings.button_label }}
      </button>
    </div>

    {%- if form.errors -%}
      <div
        id="Blocco-prova__message-error-{{ section.id }}"
        class="blocco-prova__message blocco-prova__message--error"
        tabindex="-1"
      >
        <svg
          viewBox="0 0 20 20"
          xmlns="http://www.w3.org/2000/svg"
          focusable="false"
          aria-hidden="true"
          class="icon-error"
        >
          {%- render 'icon', icon: 'error' -%}
        </svg>
        {{- form.errors.translated_fields.email | capitalize }}
        {{ form.errors.messages.email -}}
      </div>
    {%- endif -%}

    {%- if form.posted_successfully? -%}
      <div
        id="Blocco-prova__message-success-{{ section.id }}"
        class="blocco-prova__message blocco-prova__message--success"
        tabindex="-1"
      >
        <span class="svg-wrapper icon-success">
          {{ 'icon-checkmark.svg' | inline_asset_content }}
        </span>
        <p class="blocco-prova__message-text">{{ section_settings.success_message }}</p>
      </div>
    {%- endif -%}
  {% endform %}
</div>

{% stylesheet %}
  .blocco-prova {
    display: block;
    width: 100%;
  }

  .blocco-prova__heading {
    margin-bottom: var(--margin-md);
  }

  .blocco-prova__description {
    margin-bottom: var(--margin-lg);
    color: var(--color-foreground);
  }

  .blocco-prova__form {
    display: flex;
    flex-direction: column;
    gap: var(--gap-sm);
  }

  .blocco-prova__input-group {
    display: flex;
    flex-direction: column;
    gap: var(--gap-sm);
  }

  @media screen and (min-width: 750px) {
    .blocco-prova__input-group {
      flex-direction: row;
    }
  }

  .blocco-prova__input {
    flex: 1;
    padding: var(--padding-lg) var(--padding-xl);
    border: 1px solid var(--color-input-border);
    border-radius: var(--border-radius-sm);
    background-color: var(--color-input-background);
    color: var(--color-input-text);
    font-size: 1rem;
  }

  .blocco-prova__input::placeholder {
    color: rgb(var(--color-input-text-rgb) / var(--opacity-70));
  }

  .blocco-prova__input:focus {
    outline: 2px solid var(--color-foreground);
    outline-offset: 2px;
  }

  .blocco-prova__button {
    padding: var(--padding-lg) var(--padding-3xl);
    white-space: nowrap;
  }

  .blocco-prova__message {
    display: flex;
    align-items: center;
    gap: var(--gap-xs);
    margin-top: var(--margin-sm);
  }

  .blocco-prova__message--error {
    color: var(--color-error);
  }

  .blocco-prova__message--success {
    color: var(--color-success);
  }

  .blocco-prova__message-text {
    margin: 0;
  }
{% endstylesheet %}

{% schema %}
{
  "name": "SEZIONE PROVA",
  "tag": "section",
  "class": "sezione-prova",
  "settings": [
    {
      "type": "paragraph",
      "content": "Sezione per l'iscrizione alla newsletter. Gli iscritti vengono aggiunti alla lista clienti di Shopify."
    },
    {
      "type": "header",
      "content": "Contenuto"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Titolo",
      "default": "Iscriviti alla Newsletter"
    },
    {
      "type": "select",
      "id": "heading_preset",
      "label": "Stile titolo",
      "options": [
        {
          "value": "h2",
          "label": "H2"
        },
        {
          "value": "h3",
          "label": "H3"
        },
        {
          "value": "h4",
          "label": "H4"
        },
        {
          "value": "paragraph",
          "label": "Paragrafo"
        }
      ],
      "default": "h3"
    },
    {
      "type": "textarea",
      "id": "description",
      "label": "Descrizione",
      "default": "Ricevi le ultime novit√† e offerte esclusive direttamente nella tua casella email."
    },
    {
      "type": "header",
      "content": "Form"
    },
    {
      "type": "text",
      "id": "placeholder",
      "label": "Placeholder email",
      "default": "Inserisci la tua email"
    },
    {
      "type": "text",
      "id": "button_label",
      "label": "Testo pulsante",
      "default": "Iscriviti"
    },
    {
      "type": "text",
      "id": "success_message",
      "label": "Messaggio di successo",
      "default": "Grazie per l'iscrizione!"
    },
    {
      "type": "header",
      "content": "Larghezza"
    },
    {
      "type": "select",
      "id": "width",
      "label": "Larghezza",
      "options": [
        {
          "value": "fill",
          "label": "Piena"
        },
        {
          "value": "custom",
          "label": "Personalizzata"
        }
      ],
      "default": "fill"
    },
    {
      "type": "range",
      "id": "custom_width",
      "label": "Larghezza personalizzata",
      "min": 20,
      "max": 100,
      "step": 1,
      "unit": "%",
      "default": 100,
      "visible_if": "{{ section.settings.width == \"custom\" }}"
    },
    {
      "type": "header",
      "content": "Padding"
    },
    {
      "type": "range",
      "id": "padding-block-start",
      "label": "Alto",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "default": 24
    },
    {
      "type": "range",
      "id": "padding-block-end",
      "label": "Basso",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "default": 24
    },
    {
      "type": "range",
      "id": "padding-inline-start",
      "label": "Sinistra",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "default": 0
    },
    {
      "type": "range",
      "id": "padding-inline-end",
      "label": "Destra",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "default": 0
    }
  ],
  "presets": [
    {
      "name": "SEZIONE PROVA",
      "category": "t:categories.forms"
    }
  ]
}
{% endschema %}
